package cn.com.st.dss.utils;

import java.sql.SQLException;
import java.util.*;

import cn.com.st.dss.jdbc.DBConnection;

public class SelectCreatorUtil {
	public static String SqlSelector(String reportName, String attrName,
			String id, String sql) throws SQLException {
		StringBuffer sb = new StringBuffer();
		sb.append("<select id='" + reportName + "_" + attrName + "_" + id
				+ "'>");

		sb.append("<option value='*'>--请选择--</option>");

		String mysql = sql;
		DBConnection db = new DBConnection();
		db.getCurrentConnection();
		List list = db.executeQueryList(sql);
		for (int j = 0; j < list.size(); j++) {
			Map record = (Map) list.get(j);
			String[] reArray = new String[2];

			Collection l = record.values();

			Object s[] = l.toArray();

			sb.append("<option value='" + s[1] + "'>" + s[0] + "</option>");

		}

		sb.append("</select>");
		return sb.toString();
	}

	public static String myChartSelector(String id) throws SQLException {
		StringBuffer sb = new StringBuffer();
		sb.append("<select id='" + id + "'>");

		sb.append("<option value='*'>--请选择--</option>");

		String sql = "select a.fav_table_id,a.fav_chart_name,a.fav_desc from nmdss_dss_mydata_fav a left join nmdss_dss_table  b on  a.fav_table_id = b.id where a.fav_category='chart' and a.fav_status='1';";
		DBConnection db = new DBConnection();
		db.getCurrentConnection();
		List list = db.executeQueryList(sql);
		for (int j = 0; j < list.size(); j++) {
			Map record = (Map) list.get(j);
			String[] reArray = new String[3];

			Collection l = record.values();

			Object s[] = l.toArray();

			sb.append("<option value='" + s[1] + "#" + s[2] + "'>" + s[0]
			                                       					+ "</option>");
		}
		System.out.println(sql);
		sb.append("</select>");
		return sb.toString();
	}

	public static String myTableSelector(String id) throws SQLException {
		StringBuffer sb = new StringBuffer();
		sb.append("<select id='" + id + "'>");

		sb.append("<option value='*'>--请选择--</option>");

		String sql = "select a.fav_table_id,a.fav_query_condition,a.fav_desc from nmdss_dss_mydata_fav a left join nmdss_dss_table  b on  a.fav_table_id = b.id where a.fav_category='table' and a.fav_status='1';";
		DBConnection db = new DBConnection();
		db.getCurrentConnection();
		List list = db.executeQueryList(sql);
		for (int j = 0; j < list.size(); j++) {
			Map record = (Map) list.get(j);
			String[] reArray = new String[3];

			Collection l = record.values();

			Object s[] = l.toArray();

			sb.append("<option value='" + s[1] + "#" + s[2] + "'>" + s[0]
					+ "</option>");
		}

		System.out.println(sql);
		sb.append("</select>");
		return sb.toString();
	}

	public static void main(String[] args) {
		try {
			String a = SelectCreatorUtil.myTableSelector("ee");
			System.out.println(a);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
}
